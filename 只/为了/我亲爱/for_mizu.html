<style>
  html {
    scroll-behavior: smooth;
    scroll-snap-type: y mandatory;
  }

  section {
    height: 100vh;
    scroll-snap-align: start;
  }

  section h1,
  section p {
    opacity: 0;
    transform: translateY(20px);
    transition: opacity 1.8s ease, transform 1.8s ease;
  }

  .date {
    border-bottom: rgb(165, 97, 216) groove 10px;
    border-top: none;
  }

  section.active h1,
  section.active p {
    opacity: 1;
    transform: translateY(0);
  }


  body {
    font-family: "ZCOOL KuaiLe", sans-serif;
    background-image: linear-gradient(rgb(154, 90, 194), pink);
  }

.page-btn {
  position: fixed;
  bottom: 10vh;
  height: 6vh;
  width: 6vh;
  background: #fffdfa;
  border: 2px solid #b7a78a;
  border-radius: 10px;
  box-shadow: 0 4px 5px rgba(0,0,0,0.15);
  font-size: 2rem;
  font-family: "Georgia", serif;
  font-weight: bold;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;

  /* remove transform transitions */
  transition: box-shadow 0.2s ease, background 0.2s ease;
}

.page-btn-left {
  left: 10%;
  animation: wiggle-left 2.7s ease-in-out infinite;
  animation-fill-mode: both;
}

.page-btn-right {
  right: 10%;
  animation: wiggle-right 2.7s ease-in-out infinite;
  animation-fill-mode: both;
}

@keyframes wiggle-left {
  0% { transform: rotateY(0deg) translateX(0); }
  25% { transform: rotateY(18deg) translateX(-2px); }
  50% { transform: rotateY(12deg) translateX(0); }
  75% { transform: rotateY(20deg) translateX(-3px); }
  100% { transform: rotateY(0deg) translateX(0); }
}

@keyframes wiggle-right {
  0% { transform: rotateY(0deg) translateX(0); }
  25% { transform: rotateY(-18deg) translateX(2px); }
  50% { transform: rotateY(-12deg) translateX(0); }
  75% { transform: rotateY(-20deg) translateX(3px); }
  100% { transform: rotateY(0deg) translateX(0); }
}

@keyframes heartbeat {
  0%   { transform: translateX(-50%) scale(1); }
  14%  { transform: translateX(-50%) scale(1.2); }
  28%  { transform: translateX(-50%) scale(1); }
  42%  { transform: translateX(-50%) scale(1.2); }
  70%  { transform: translateX(-50%) scale(1); }
  100% { transform: translateX(-50%) scale(1); }
}

@keyframes wiggle-assets {  
  0%   { transform: rotate(0deg) scale(1); }
  25%  { transform: rotate(3deg) scale(1.05); }
  50%  { transform: rotate(0deg) scale(0.97); }
  75%  { transform: rotate(-3deg) scale(1.04); }
  100% { transform: rotate(0deg) scale(1); }
}

#scrollHeart {
  position: fixed;
  bottom: 10vh;
  left: 50%;
  transform: translateX(-50%);
  font-size: 3rem;

  /* Start as outline */
  color: transparent;
  -webkit-text-stroke: 2px #ff4d6d;

  /* Gradient fill controlled by JS */
  background: linear-gradient(to top, #ff4d6d 0%, transparent 0%);
  -webkit-background-clip: text;
  background-clip: text;

  pointer-events: none;
}

</style>

<script src="https://kit.fontawesome.com/b20253bfc0.js" crossorigin="anonymous"></script>
<script>
  let currentScene = 0;
  const maxScene = 5; // since scene6 → index 5

  function pauseHeartbeat() {
    const heart = document.getElementById("scrollHeart");
    heart.style.animationPlayState = "paused";
    heart.style.transform = "translateX(-50%) scale(1)"; // reset scale
  }

  function resumeHeartbeat() {
    const heart = document.getElementById("scrollHeart");
    heart.style.animationPlayState = "running";
  }

  window.addEventListener("scroll", () => {
    // // Compute the current section index
    // const scene = Math.round(window.scrollY / window.innerHeight);
    // const clamped = Math.max(0, Math.min(maxScene, scene));

    // if (clamped !== currentScene) {
    //   currentScene = clamped;

    //   // Update buttons whenever the scene changes
    //   updateButtons();
    // }

    // Update heart fill as before
    const rect = document.getElementById("heartFillRect");
    const maxScroll = document.body.scrollHeight - window.innerHeight;
    const scrollPercent = window.scrollY / maxScroll;
    const newY = 100 - scrollPercent * 100;
    rect.setAttribute("y", newY);

    // Update heartbeat speed dynamically
    const heart = document.getElementById("scrollHeart");
    const minSpeed = 0.9;
    const maxSpeed = 2.2;
    const newDuration = maxSpeed - (scrollPercent * (maxSpeed - minSpeed));
    heart.style.animationDuration = newDuration + "s";
  });

  function updateButtons() {
    const leftBtn = document.querySelector('.page-btn-left');
    const rightBtn = document.querySelector('.page-btn-right');

    // hide left button on first page
    if (currentScene === 0) {
      leftBtn.style.display = "none";
    } else {
      leftBtn.style.display = "flex";
    }

    // hide right button on last page
    if (currentScene === maxScene) {
      rightBtn.style.display = "none";
    } else {
      rightBtn.style.display = "flex";
    }
  }

  function goPrevPage() {
    if (currentScene > 0) currentScene -= 1;

    pauseHeartbeat();

    window.scrollTo({
      top: currentScene * window.innerHeight,
      behavior: "smooth"
    });

    setTimeout(() => {
      resumeHeartbeat();
    }, 300); // matches smooth scroll timing

    updateButtons();
  }

  function goNextPage() {
    if (currentScene < maxScene) currentScene += 1;

    pauseHeartbeat();

    window.scrollTo({
      top: currentScene * window.innerHeight,
      behavior: "smooth"
    });

    setTimeout(() => {
      resumeHeartbeat();
    }, 300);

    updateButtons();
  }


  // run once when page loads
  window.onload = updateButtons;

  window.addEventListener("scroll", () => {
    const rect = document.getElementById("heartFillRect");

    const maxScroll = document.body.scrollHeight - window.innerHeight;
    const scrollPercent = window.scrollY / maxScroll;

    // From y = 100 (empty) → y = 0 (full)
    const newY = 100 - scrollPercent * 100;

    rect.setAttribute("y", newY);
  });

  window.addEventListener("scroll", () => {
    const heart = document.getElementById("scrollHeart");

    const maxScroll = document.body.scrollHeight - window.innerHeight;
    const percent = window.scrollY / maxScroll; // 0 → 1

    // Range: slowest = 2.4s, fastest = 0.9s (you can tune these)
    const minSpeed = 0.9;
    const maxSpeed = 2.2;

    const newDuration = maxSpeed - (percent * (maxSpeed - minSpeed));
    heart.style.animationDuration = newDuration + "s";
  });

  function updateActiveSection() {
    const sections = document.querySelectorAll("section");
    const scrollPos = window.scrollY;
    const windowHeight = window.innerHeight;

    sections.forEach((section, index) => {
      const sectionTop = section.offsetTop;
      const sectionBottom = sectionTop + section.offsetHeight;

      // Section is centered in the viewport
      if (scrollPos + windowHeight * 0.5 >= sectionTop &&
          scrollPos + windowHeight * 0.5 < sectionBottom) {

        section.classList.add("active");

        if (currentScene !== index) {
          currentScene = index;
          updateButtons();
        }

      } else {
        section.classList.remove("active");
      }
    });
  }



  // Run on scroll
  window.addEventListener("scroll", updateActiveSection);

  // Run on page load
  window.addEventListener("load", updateActiveSection);

</script>

<head>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=ZCOOL+KuaiLe&display=swap" rel="stylesheet">
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>For Mizu</title>
</head>
<section id="scene1">
  <!-- scene 1 content -->
   <h1 style="text-align: center; font-size: 2.5rem; margin: auto; height: 45vh;"><div class="date">April 12, 2025</div></h1>
    <p style="text-align: center; font-size: 2.5rem; margin: auto;">
    第一天见到你
    </p>
</section>

<section id="scene2">
  <!-- scene 2 content -->
  <h1 style="text-align: center; font-size: 2.5rem; margin: auto; height: 45vh;"><div class="date">August 5, 2025</div></h1>
    <p style="text-align: center; font-size: 2.5rem; margin: auto;">
    第一次跟你讲话和打mai
    </p>
</section>

<section id="scene3">
  <!-- scene 3 content -->
  <h1 style="text-align: center; font-size: 2.5rem; margin: auto; height: 45vh;"><div class="date">October 5, 2025</div></h1>
    <p style="text-align: center; font-size: 2.5rem; margin: auto;">
    跟你庆祝生日,然后跟你告白
    </p>
</section>

<section id="scene4">
  <!-- scene 4 content -->
  <h1 style="text-align: center; font-size: 2.5rem; margin: auto; height: 10vh;"><div class="date">December 25, 2025</div></h1>
    <p style="text-align: center; font-size: 2.5rem; margin: auto;">
    首先道歉，我的华语还是很烂。<br>
    其实，我不太会面对面讲话时表达自己感情的，比较会用写的方式。<br>
    想跟你说一些心里话<br>
</section>

<section id="scene5">
  <!-- scene 5 content -->
  <h1 style="text-align: center; font-size: 2.5rem; margin: auto; height: 10vh;"></h1>
    <p style="text-align: center; font-size: 2.5rem; margin: auto;">
    虽然认识了不到半年，但感觉像你是我命中注定遇见的人。<br>
    你是第一个会想要理解我，会对我有耐心的，<br>
    而且在我身边时候让我感觉到自己的存在是被需要的，和被想要的。<br>
    <!-- 我们认识的这几个月已让我感觉到对一位有多重要的，<br> -->
</section>

<section id="scene6">
  <!-- scene 6 content -->
  <h1 style="text-align: center; font-size: 2.5rem; margin: auto; height: 10vh;"></h1>
    <p style="text-align: center; font-size: 2.5rem; margin: auto;">
    我会永远感激上天，不只有的机会遇见你这位在我心里如此珍贵的，但又感激有的机会在不知不觉中爱上了你。<br>
    希望未来的日子里，我们可以一起走下去。不管是开心还是难过的时刻，我都想陪在你身边。<br>
    希望你也能感受到我对你的爱意。<br>
    </p>
</section>

<div class="page-btn page-btn-left" onclick="goPrevPage()">
  <i class="fa-solid fa-arrow-left"></i>
</div>

<svg id="scrollHeart" width="80" height="80" viewBox="0 0 100 100" style="
  animation: heartbeat 2.4s infinite;
  position: fixed;
  bottom: 10vh;
  left: 50%;
  transform: translateX(-50%);
  pointer-events: none;
  color: #ff4d6d; text-shadow: 0 0 5px #ff4d6d, 0 0 10px #ff4d6d;
">
  <!-- Heart Outline -->
  <path id="heartOutline"
    d="M50 82 L20 52 C5 37 5 15 25 10 C35 8 45 14 50 22 C55 14 65 8 75 10 C95 15 95 37 80 52 Z"
    fill="none"
    stroke="#ff4d6d"
    stroke-width="5"
  />

  <!-- Red Fill -->
  <defs>
    <clipPath id="heartClip">
      <path
        d="M50 82 L20 52 C5 37 5 15 25 10 C35 8 45 14 50 22 C55 14 65 8 75 10 C95 15 95 37 80 52 Z"
      ></path>
    </clipPath>
  </defs>

  <!-- Gradual Fill Rectangle -->
  <rect id="heartFillRect"
    x="0" y="100"
    width="100" height="100"
    fill="#ff4d6d"
    clip-path="url(#heartClip)"
  />
</svg>

<!-- <script>
document.getElementById("scrollHeart").addEventListener("click", () => {
  const next = document.querySelector("section:nth-of-type(2)");
  next.scrollIntoView({ behavior: "smooth" });
});
</script> -->

<div class="page-btn page-btn-right" onclick="goNextPage()">
  <i class="fa-solid fa-arrow-right"></i>
</div>

<div style="position: fixed; left: 3%; bottom: 25%; animation: wiggle-assets 1.9s infinite; opacity: 0.5;">
  <img src="../../../strawberry.png" style="width: 5vh; height: 5vh;" />
</div>

<div style="position: fixed; left: 1%; top:0%; animation: wiggle-assets 1.9s infinite;">
  <img src="../../../pencil.png" style="width: 5vh; height: 5vh;" />
</div>

<!-- <div style="position: fixed; bottom: 10vh; left: 35%;">
  <button onclick="window.scrollTo(0, (currentScene - 1) % 6 * window.innerHeight)" style="background: transparent; border: 1px black; height: 5vh; width: 5vh;">
    <i class="fa-solid fa-arrow-left" style="animation: arrow-bounce-left 1.5s ease infinite; transform: translateX(-10px);"></i>
  </button>
</div>

<div style="position: fixed; bottom: 10vh; right: 35%;">
  <button onclick="window.scrollTo(0, (currentScene + 1) % 6 * window.innerHeight)" style="background: transparent; border: 1px black; height: 5vh; width: 5vh;">
    <i class="fa-solid fa-arrow-right" style="animation: arrow-bounce-right 1.5s ease infinite; transform: translateX(10px);"></i>
  </button>
</div> -->

<style>

</style>


