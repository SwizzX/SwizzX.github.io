<!-- =======================  CSS  ======================= -->
<style>
  html {
    scroll-behavior: smooth;
    scroll-snap-type: y mandatory;
  }

  section {
    height: calc(var(--vh) * 100);
    scroll-snap-align: start;
  }

  section h1,
  section p {
    opacity: 0;
    transform: translateY(20px);
    transition: opacity 1.8s ease, transform 1.8s ease;
  }

  .section-inner {
    height: calc(var(--vh) * 100 - 18vh);
    flex-direction: column;
    padding: 2rem;
    box-sizing: border-box;
    font-size: clamp(2rem, 3.2vw, 2.5rem);
  }

  .date {
    border-bottom: rgb(165, 97, 216) groove 10px;
  }

  section.active h1,
  section.active p {
    opacity: 1;
    transform: translateY(0);
  }

  body {
    font-family: "ZCOOL KuaiLe", sans-serif;
    background-image: linear-gradient(rgb(154, 90, 194), pink);
  }

  .page-btn {
    position: fixed;
    bottom: 10vh;
    height: 6vh;
    width: 6vh;
    background: #fffdfa;
    border: 2px solid #b7a78a;
    border-radius: 10px;
    box-shadow: 0 4px 5px rgba(0,0,0,0.15);
    font-size: 2rem;
    font-family: Georgia, serif;
    font-weight: bold;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: box-shadow 0.2s ease, background 0.2s ease;
  }

  .page-btn-left {
    left: 10%;
    animation: wiggle-left 2.7s ease-in-out infinite;
  }
  .page-btn-right {
    right: 10%;
    animation: wiggle-right 2.7s ease-in-out infinite;
  }

  @keyframes wiggle-left {
    0% { transform: rotateY(0deg) translateX(0); }
    25% { transform: rotateY(18deg) translateX(-2px); }
    50% { transform: rotateY(12deg) translateX(0); }
    75% { transform: rotateY(20deg) translateX(-3px); }
    100% { transform: rotateY(0deg) translateX(0); }
  }

  @keyframes wiggle-right {
    0% { transform: rotateY(0deg) translateX(0); }
    25% { transform: rotateY(-18deg) translateX(2px); }
    50% { transform: rotateY(-12deg) translateX(0); }
    75% { transform: rotateY(-20deg) translateX(3px); }
    100% { transform: rotateY(0deg) translateX(0); }
  }

  @keyframes heartbeat {
    0%   { transform: translateX(-50%) scale(1); }
    14%  { transform: translateX(-50%) scale(1.2); }
    28%  { transform: translateX(-50%) scale(1); }
    42%  { transform: translateX(-50%) scale(1.2); }
    70%  { transform: translateX(-50%) scale(1); }
    100% { transform: translateX(-50%) scale(1); }
  }

  @keyframes wiggle-assets {
    0%   { transform: rotate(0deg) scale(1); }
    25%  { transform: rotate(3deg) scale(1.05); }
    50%  { transform: rotate(0deg) scale(0.97); }
    75%  { transform: rotate(-3deg) scale(1.04); }
    100% { transform: rotate(0deg) scale(1); }
  }

  #scrollHeart {
    position: fixed;
    bottom: 10vh;
    left: 50%;
    transform: translateX(-50%);
    font-size: 3rem;
    color: transparent;
    -webkit-text-stroke: 2px #ff4d6d;
    background: linear-gradient(to top, #ff4d6d 0%, transparent 0%);
    -webkit-background-clip: text;
    pointer-events: none;
    animation: heartbeat 2.4s infinite;
  }

  #introScreen {
    position: fixed;
    width: 100vw;
    height: 100vh;
    top: 0;
    left: 0;
    background: #fff0f5;
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 99999;
    cursor: pointer;
    opacity: 1;
    transition: opacity 1.4s ease;
  }

  #introContent {
    text-align: center;
    font-size: 3vh;
    color: #ff4d6d;
  }

  .introHeart {
    font-size: 12vh;
    animation: introbeat 1.8s infinite ease-in-out;
  }

  @keyframes introbeat {
    0%, 100% { transform: scale(1); }
    50% { transform: scale(1.18); }
  }

  #musicToggle {
    animation: tinybeat 2.2s infinite ease-in-out;
  }

  @keyframes tinybeat {
    0%, 100% { transform: scale(1); }
    50% { transform: scale(1.15); }
  }
</style>

<audio id="bgAudio" src="igyet.mp3" autoplay loop muted></audio>

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">


<!-- =======================  MAIN SCRIPT ======================= -->
<script>
  function setVh() {
    let vh = window.innerHeight * 0.01;
    document.documentElement.style.setProperty('--vh', `${vh}px`);
  }
  setVh();
  window.addEventListener('resize', setVh);

  let currentScene = 0;
  const maxScene = 6;

  function getTrueHeight() {
    return parseFloat(getComputedStyle(document.documentElement).getPropertyValue('--vh')) * 100;
  }

  function pauseHeartbeat() {
    const h = document.getElementById("scrollHeart");
    h.style.animationPlayState = "paused";
    h.style.transform = "translateX(-50%) scale(1)";
  }

  function resumeHeartbeat() {
    document.getElementById("scrollHeart").style.animationPlayState = "running";
  }

  window.addEventListener("scroll", () => {
    const rect = document.getElementById("heartFillRect");
    const maxScroll = document.body.scrollHeight - window.innerHeight;
    const scrollPercent = window.scrollY / maxScroll;
    rect.setAttribute("y", 100 - scrollPercent * 100);
    
    const heart = document.getElementById("scrollHeart");
    const minSpeed = 0.9, maxSpeed = 2.2;
    heart.style.animationDuration = (maxSpeed - scrollPercent * (maxSpeed - minSpeed)) + "s";
  });

  function updateButtons() {
    const leftBtn  = document.querySelector(".page-btn-left");
    const rightBtn = document.querySelector(".page-btn-right");
    leftBtn.style.display  = currentScene === 0 ? "flex" : "flex";
    rightBtn.style.display = currentScene === maxScene ? "flex" : "flex";
  }

  function goPrevPage() {
    if (currentScene === 0) return spawnFloatingHeart();
    pauseHeartbeat();
    currentScene--;
    window.scrollTo({ top: currentScene * getTrueHeight(), behavior: "smooth" });
    setTimeout(resumeHeartbeat, 300);
    updateSceneIndicator();
  }

  function goNextPage() {
    if (currentScene === maxScene) return spawnFloatingHeart();
    pauseHeartbeat();
    currentScene++;
    window.scrollTo({ top: currentScene * getTrueHeight(), behavior: "smooth" });
    setTimeout(resumeHeartbeat, 300);
    updateSceneIndicator();
  }

  function spawnFloatingHeart() {
    const heart = document.createElement("div");
    heart.textContent = "ğŸ’—";
    heart.style.position = "fixed";
    heart.style.left = Math.random() * 85 + 5 + "%";
    heart.style.top  = Math.random() * 70 + 20 + "%";
    heart.style.fontSize = (Math.random() * 20 + 25) + "px";
    heart.style.opacity = "1";
    heart.style.transition = "transform 1.8s ease-out, opacity 1.8s ease-out";
    document.body.appendChild(heart);
    requestAnimationFrame(() => {
      heart.style.transform = "translateY(-80px)";
      heart.style.opacity = "0";
    });
    setTimeout(() => heart.remove(), 2000);
  }

  function updateActiveSection() {
    const sections = document.querySelectorAll("section");
    const scrollPos = window.scrollY;
    const windowHeight = window.innerHeight;

    sections.forEach((section, index) => {
      const top = section.offsetTop;
      const bottom = top + section.offsetHeight;

      if (scrollPos + windowHeight * 0.5 >= top &&
          scrollPos + windowHeight * 0.5 < bottom) {
        section.classList.add("active");
        if (currentScene !== index) {
          currentScene = index;
          updateSceneIndicator();
          updateButtons();
        }
      } else {
        section.classList.remove("active");
      }
    });
  }

  window.addEventListener("scroll", updateActiveSection);
  window.addEventListener("load", updateActiveSection);

  function updateSceneIndicator() {
    document.getElementById("sceneIndicator").textContent = "scene: " + (currentScene + 1);
  }
</script>

<!-- =======================  HEAD  ======================= -->
<head>
  <meta charset="UTF-8">
  <link rel="icon" href="../../../strawberry.png" type="image/png" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="https://fonts.googleapis.com/css2?family=ZCOOL+KuaiLe&display=swap" rel="stylesheet">
  <title>For Mizu</title>
</head>

<!-- =======================  INTRO SCREEN ======================= -->
<div id="introScreen">
  <div id="introContent">
    <div class="introHeart">ğŸ’Œ</div>
    <p>Tap to open the letter</p>
  </div>
</div>

<!-- ========== FIXED: UPDATEBUTTONS ADDED TO ONLOAD ========== -->
<script>
  window.onload = () => {
    const intro  = document.getElementById("introScreen");
    const audio  = document.getElementById("bgAudio");
    const toggle = document.getElementById("musicToggle");

    let musicOn = false;
    audio.volume = 0.225;

    intro.addEventListener("click", () => {
      audio.muted = false;
      audio.play();
      musicOn = true;

      intro.style.opacity = 0;
      setTimeout(() => intro.style.display = "none", 1400);

      toggle.style.display = "block";
    });

    toggle.addEventListener("click", () => {
      if (musicOn) { audio.pause(); musicOn = false; }
      else        { audio.play();  musicOn = true; }
    });

    /* ğŸ”¥ Your request: call updateButtons at bottom */
    updateButtons();
  };
</script>

<!-- =======================  SECTIONS  ======================= -->

<section id="scene1">
  <!-- scene 1 content -->
   <div class="section-inner">
    <h1 style="text-align: center; font-size: 2.5rem; margin: auto; height: 42.5vh;"><div class="date">April 12, 2025</div></h1>
      <p style="text-align: center; margin: auto;">
      ç¬¬ä¸€å¤©è§åˆ°ä½ 
      </p>
   </div>
</section>

<section id="scene2">
  <!-- scene 2 content -->
   <div class="section-inner">
    <h1 style="text-align: center; font-size: 2.5rem; margin: auto; height: 42.5vh;"><div class="date">August 5, 2025</div></h1>
      <p style="text-align: center; margin: auto;">
      ç¬¬ä¸€æ¬¡è·Ÿä½ è®²è¯å’Œæ‰“mai
      </p>
   </div>
</section>

<section id="scene3">
  <!-- scene 3 content -->
   <div class="section-inner">
    <h1 style="text-align: center; font-size: 2.5rem; margin: auto; height: 42.5vh;"><div class="date">October 5, 2025</div></h1>
      <p style="text-align: center; margin: auto;">
      è·Ÿä½ åº†ç¥ç”Ÿæ—¥,ç„¶åè·Ÿä½ å‘Šç™½
      </p>
   </div>
</section>

<section id="scene4">
  <!-- scene 4 content -->
   <div class="section-inner">
    <h1 style="text-align: center; font-size: 2.5rem; margin: auto; height: 10vh;"><div class="date">December 25, 2025</div></h1>
      <p style="text-align: center; margin: auto;">
      é¦–å…ˆé“æ­‰ï¼Œæˆ‘çš„åè¯­è¿˜æ˜¯å¾ˆçƒ‚ã€‚<br>
      å…¶å®ï¼Œæˆ‘ä¸å¤ªä¼šé¢å¯¹é¢è®²è¯æ—¶è¡¨è¾¾è‡ªå·±æ„Ÿæƒ…çš„ï¼Œæ¯”è¾ƒä¼šç”¨å†™çš„æ–¹å¼ã€‚<br>
      æƒ³è·Ÿä½ è¯´ä¸€äº›å¿ƒäº‹<br>
      </p>
    </div>
</section>

<section id="scene5">
  <!-- scene 5 content -->
   <div class="section-inner">
    <h1 style="text-align: center; margin: auto; height: 10vh;"></h1>
      <p style="text-align: center; margin: auto;">
      è™½ç„¶è®¤è¯†ä¸ä¹…ï¼Œä½†ä½ ç»™æˆ‘çš„æ„Ÿè§‰åƒæ˜¯æ—©å°±åœ¨æˆ‘ç”Ÿå‘½é‡Œå äº†ä¸€ä¸ªä½ç½®ï¼Œä¹Ÿåƒæ˜¯æˆ‘å‘½ä¸­æ³¨å®šä¼šç›¸é‡çš„äººã€‚<br>
      ä½ æ˜¯ç¬¬ä¸€ä¸ªä¼šæƒ³è¦ç†è§£æˆ‘ï¼Œä¼šå¯¹æˆ‘æœ‰è€å¿ƒçš„ï¼Œ<br>
      è€Œä¸”åœ¨æˆ‘èº«è¾¹æ—¶å€™è®©æˆ‘æ„Ÿè§‰åˆ°è‡ªå·±çš„å­˜åœ¨æ˜¯è¢«éœ€è¦çš„ï¼Œå’Œè¢«æƒ³è¦çš„ã€‚<br>
      </p>
    </div>
</section>

<section id="scene6">
  <!-- scene 6 content -->
   <div class="section-inner">
    <h1 style="text-align: center; margin: auto; height: 10vh;"></h1>
      <p style="text-align: center; margin: auto;">
      ä½ ä¹‹å‰æœ‰è®²è¿‡ï¼Œæ„Ÿè§‰æˆ‘ä»¬å½¼æ­¤éƒ½äº’ç›¸å¾ˆéœ€è¦å¯¹æ–¹ï¼Œä½†æˆ‘æ²¡æœºä¼šå‘Šè¯‰ä½ ä½ å¯¹æˆ‘æœ‰å¤šé‡è¦ï¼Œè€Œä½ å‡ºç°åï¼Œç”Ÿå‘½æœ‰å˜é“å¤šå¥½ã€‚<br>
      æ›¾ç»æœ‰è·Ÿä½ è®²ï¼Œæˆ‘é€šå¸¸ä¸ä¼šè½»æ˜“è·Ÿè®¤è¯†çš„äººè¯´æˆ‘å‘ç”Ÿè¿‡çš„äº‹ï¼Œå› ä¸ºä¹ æƒ¯äº†æˆ‘çš„æ•…äº‹ç»™äººå®¶ä¼ å‡ºå»äº†ï¼Œè¢«ç¬‘è¢«å˜²ã€‚<br>
      ä½ ä¸åªè®©æˆ‘æœ‰å¿ƒé‡Œçš„å®‰å…¨æ„Ÿï¼Œå½“ä½œæˆ‘è·Ÿä½ è®²çš„äº‹æ˜¯çœŸçš„ä½ ä¼šå¿ƒé‡Œä¿æŠ¤ï¼Œ<br>
      ä½†åˆè®©æˆ‘æ‰¾äº†ä¸€ä½ï¼Œä¸ç®¡ä¼¤å¿ƒæˆ–å¼€å¿ƒï¼Œæˆ‘ä»€ä¹ˆäº‹éƒ½å¯ä»¥æ”¾å¿ƒæ²¡ä»€ä¹ˆå‹åŠ›çš„è·Ÿä½ è¯´ã€‚<br>
      </p>
    </div>
</section>

<section id="scene7">
  <!-- scene 7 content -->
   <div class="section-inner">
    <h1 style="text-align: center;margin: auto; height: 10vh;"></h1>
      <p style="text-align: center; margin: auto;">
      æˆ‘ä¼šæ°¸è¿œæ„Ÿæ¿€ä¸Šå¤©ï¼Œä¸åªæœ‰çš„æœºä¼šé‡è§ä½ è¿™ä½åœ¨æˆ‘å¿ƒé‡Œå¦‚æ­¤çè´µçš„ï¼Œ<br>
      ä½†åˆæ„Ÿæ¿€æœ‰çš„æœºä¼šåœ¨ä¸çŸ¥ä¸è§‰ä¸­çˆ±ä¸Šäº†ä¸–ç•Œä¸Šæœ€å®Œç¾çš„ä¸€ä½ã€‚<br>
      å¸Œæœ›æœªæ¥çš„æ—¥å­é‡Œï¼Œæˆ‘ä»¬å¯ä»¥ä¸€èµ·èµ°ä¸‹å»,ä¸ç®¡æ˜¯å¼€å¿ƒè¿˜æ˜¯éš¾è¿‡çš„æ—¶åˆ»ï¼Œæˆ‘éƒ½æƒ³é™ªåœ¨ä½ èº«è¾¹ã€‚<br>
      è™½ç„¶æ°¸è¿œè®²ä¸å®Œæˆ‘æœ‰å¤šçˆ±ä½ çš„äº‹ï¼Œè€Œåˆè®²åˆ°ä¸æ¸…æ¥šï¼Œå¸Œæœ›ä½ ä¹Ÿèƒ½æ„Ÿå—åˆ°æˆ‘å¯¹ä½ çš„çˆ±æ„ã€‚<br>
      </p>
    </div>
</section>

<div class="page-btn page-btn-left" onclick="goPrevPage()">
  <i class="fa-solid fa-arrow-left"></i>
</div>

<svg id="scrollHeart" width="80" height="80" viewBox="0 0 100 100" style="
  animation: heartbeat 2.4s infinite;
  position: fixed;
  bottom: 10vh;
  left: 50%;
  transform: translateX(-50%);
  pointer-events: none;
  color: #ff4d6d; text-shadow: 0 0 5px #ff4d6d, 0 0 10px #ff4d6d;
">
  <!-- Heart Outline -->
  <path id="heartOutline"
    d="M50 82 L20 52 C5 37 5 15 25 10 C35 8 45 14 50 22 C55 14 65 8 75 10 C95 15 95 37 80 52 Z"
    fill="none"
    stroke="#ff4d6d"
    stroke-width="5"
  />

  <!-- Red Fill -->
  <defs>
    <clipPath id="heartClip">
      <path
        d="M50 82 L20 52 C5 37 5 15 25 10 C35 8 45 14 50 22 C55 14 65 8 75 10 C95 15 95 37 80 52 Z"
      ></path>
    </clipPath>
  </defs>

  <!-- Gradual Fill Rectangle -->
  <rect id="heartFillRect"
    x="0" y="100"
    width="100" height="100"
    fill="#ff4d6d"
    clip-path="url(#heartClip)"
  />
</svg>

<!-- <script>
document.getElementById("scrollHeart").addEventListener("click", () => {
  const next = document.querySelector("section:nth-of-type(2)");
  next.scrollIntoView({ behavior: "smooth" });
});
</script> -->

<div class="page-btn page-btn-right" onclick="goNextPage()">
  <i class="fa-solid fa-arrow-right"></i>
</div>

<div style="position: fixed; left: 3%; bottom: 25%; animation: wiggle-assets 1.9s infinite; opacity: 0.5;">
  <img src="../../../strawberry.png" style="width: 5vh; height: 5vh;" />
</div>

<div style="position: fixed; left: 1%; top:0%; animation: wiggle-assets 1.9s infinite;">
  <img src="../../../pencil.png" style="width: 5vh; height: 5vh;" />
</div>

<div id="sceneIndicator"
     style="
       position: fixed;
       top: 1rem;
       right: 1rem;
       background: rgba(0,0,0,0.4);
       color: white;
       padding: 6px 12px;
       border-radius: 8px;
       font-size: 1rem;
       font-family: monospace;
       z-index: 9999;
     ">
  scene: 1
</div>

<div id="musicToggle"
     style="
       position: fixed;
       bottom: 2.6vh;
       right: 40%;
       width: 7vh;
       height: 7vh;
       cursor: pointer;
       z-index: 9999;
       display: none;
     ">
  <i class="fa-solid fa-music" style="font-size: 4vh; color: #400065;"></i>
  <!-- <svg id="musicHeart" viewBox="0 0 100 100" style="width:100%; height:100%;">
    <path d="M50 82 L20 52 C5 37 5 15 25 10 C35 8 45 14 50 22 C55 14 65 8 75 10 C95 15 95 37 80 52 Z"
          fill="#ff4d6d">
    </path>
  </svg> -->
</div>

<!-- <div style="position: fixed; bottom: 10vh; left: 35%;">
  <button onclick="window.scrollTo(0, (currentScene - 1) % 6 * window.innerHeight)" style="background: transparent; border: 1px black; height: 5vh; width: 5vh;">
    <i class="fa-solid fa-arrow-left" style="animation: arrow-bounce-left 1.5s ease infinite; transform: translateX(-10px);"></i>
  </button>
</div>

<div style="position: fixed; bottom: 10vh; right: 35%;">
  <button onclick="window.scrollTo(0, (currentScene + 1) % 6 * window.innerHeight)" style="background: transparent; border: 1px black; height: 5vh; width: 5vh;">
    <i class="fa-solid fa-arrow-right" style="animation: arrow-bounce-right 1.5s ease infinite; transform: translateX(10px);"></i>
  </button>
</div> -->

<style>

</style>


